(import "test")


($test (+ 1111111111111111111111111111111  12) 1111111111111111111111111111123)
($test (+ -81272333331928888888888888888888 -9287319287981237469182378) -81272342619248176870126358071266)
($test (* 1111111111111111111111111111111  12) 13333333333333333333333333333332)
($test (* 12312831928739187223123827 9183209812302983091829382) 113071318985235168783240693245801852357698142884914)
($test (* 2888888888888888888888888888888888 9999999999999999999999999999999) 28888888888888888888888888888885991111111111111111111111111111112)
($test (* 11111111111111111111111111111111111111 2) 22222222222222222222222222222222222222)
($test (- 1111111111111111111111111111111111111111111111111111 111111111111111111111111111111111111113) 1111111111110999999999999999999999999999999999999998)
($test (+ -283172983728888888888128712999999999 387192888888888888888888888888) -283172596535999999999239824111111111)
($test (+ 283742983749283742934792373477 -12877192837298723128888888) 283730106556446444211663484589)
($test (- 11111111111111111111111111111 11111111111111111111111111111) 0)
($test (- 11111111111111111111111111111 11111111111111111111111111110) 1)

($test (div 11111111111111111111111111111111111111111111 11111111111111111111111111111111111111111111) 1)
($test (div 11111111111111111111111111111111111111111111 1111111111111111111111111111111111111111111) 10)
($test (div 11111111111111111111111111111111111111111111 1) 11111111111111111111111111111111111111111111)
($test (div 100000000000000000000000000000000000000000000000 100000000000000000000000000) 1000000000000000000000)
($test (div 1000000000000002000000000000000 1000001000000000) 999999000001001)
($test (* 100000000000000000000000000 1000000000000000000000) 100000000000000000000000000000000000000000000000)

($test (convert 2837912874982137192837192837287312947728 <float>) 2.83791e+39 =)

($test (= (* (expt 8 5999) (expt 9 5999)) (* (expt 8 5999) (expt 9 5999))) t)
($test (= (* (expt 2 5999) (expt 3 5999)) (* (expt 3 5999) (expt 2 5999))) t)
($test (= (* (expt 2 599) (expt 3 5999)) (* (expt 3 5999) (expt 2 599))) t)
($test (= (* (expt 2 59) (expt 3 5999)) (* (expt 3 5999) (expt 2 59))) t)
($test (= (* (expt 3 10999) (expt 2 10999)) (* (expt 3 10999) (expt 2 10999))) t)
($test (= (* (expt 3 10999) (expt 3 10929)) (* (expt 3 10999) (expt 3 10929))) t)

(defglobal a (expt 8 70000))
(defglobal b (expt 9 70000))

(defun bigtest (n)
    (if (= n 0)
        t
        (progn (* a b) (bigtest (- n 1)))))



(defun foo (x)
    (let ((y 11111111111111111111111111111111111122222222222222222222222222222222))
       (lambda (z) (+ x y z))))

(defglobal f (foo 3))

($test (funcall f 2) 11111111111111111111111111111111111122222222222222222222222222222227)

($test (gcd (expt 2 60) (expt 4 60)) 1152921504606846976)
($test (convert (expt 2 90) <string>)  "1237940039285380274899124224")
($test (convert (- (expt 2 90)) <string>) "-1237940039285380274899124224")

($test (gcd 54654687987235468779 898797821321321321) 19)
($test (gcd 985649816546546879654322 5465871654654654879821321) 1)
($test (lcm 985649816546546879654322 5465871654654654879821321) 5387435393677331223281894676732342160481605399362)
($test (gcd 9856498165465468 546587165465465487) 11)
($test (lcm 9856498165465468 546587165465465487) 489766853970666434383746422209356)
($test (gcd 12345678901234567890 98765432109876543210) 900000000090)
($test (lcm 12345678901234567890 98765432109876543210) 1354807012498094801236261410)
($test (gcd 9223372036854775807 18446744073709551615) 1)
($test (lcm 9223372036854775807 18446744073709551615) 170141183460469231704017187605319778305)
($test (gcd 1000000000000000000000000000000000 5000000000000000000000000000000000) 1000000000000000000000000000000000)
($test (lcm 1000000000000000000000000000000000 5000000000000000000000000000000000) 5000000000000000000000000000000000)
($test (gcd 314159265358979323846 271828182845904523536) 2)
($test (lcm 314159265358979323846 271828182845904523536) 42698671113367835327277311454613036519728)
($test (gcd 600851475143 13195) 1)
($test (lcm 600851475143 13195) 7928235214511885)

; Addition
($test (+ 12345678901234567890 98765432109876543210) 111111111011111111100)

; Subtraction
($test (- 98765432109876543210 12345678901234567890) 86419753208641975320)

; Multiplication
($test (* 12345678901234567890 98765432109876543210) 1219326311370217952237463801111263526900)

; Division (returns quotient)
($test (div 98765432109876543210 12345678901234567890) 8)

; Modulus (remainder)
($test (mod 98765432109876543210 12345678901234567890) 900000000090)


; Maximum value
($test (max 12345678901234567890 98765432109876543210 1928374655647382910) 98765432109876543210)

; Minimum value
($test (min 12345678901234567890 98765432109876543210 1928374655647382910) 1928374655647382910)

; Numerical comparisons
($test (< 12345678901234567890 98765432109876543210) t)
($test (> 98765432109876543210 12345678901234567890) t)
($test (<= 12345678901234567890 98765432109876543210) t)
($test (>= 98765432109876543210 12345678901234567890) t)
($test (= 12345678901234567890 12345678901234567890) t)
($test (/= 12345678901234567890 98765432109876543210) t)

; Logical operations
($test (and t t) t)
($test (or nil t) t)
($test (not nil) t)

; Absolute value
($test (abs -12345678901234567890) 12345678901234567890)

; Power
($test (expt 12345678901234567890 2) 152415787532388367501905199875019052100)

; Numeric type checks
($test (numberp 12345678901234567890) t)
($test (integerp 12345678901234567890) t)

; Type conversion
($test (float 12345678901234567890) 1.2345678901234568e+19)

(format (standard-output) "Bignum all $tests are done!~%")